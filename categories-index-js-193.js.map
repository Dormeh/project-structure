{"version":3,"sources":["webpack://project-structure/./src/components/notification/index.js","webpack://project-structure/./src/components/sortable-list/index.js","webpack://project-structure/./src/pages/categories/index.js","webpack://project-structure/./src/utils/fetch-json.js"],"names":["NotificationMessage","constructor","message","duration","type","this","render","isAlreadyShow","remove","getTemplate","element","document","createElement","innerHTML","firstElementChild","classList","add","show","body","append","setTimeout","destroy","SortableList","items","event","target","closest","preventDefault","elMove","elShift","pageY","getBoundingClientRect","top","dragStart","removeItem","moveDraggingAt","clientX","clientY","style","display","elemBelow","elementFromPoint","elFromList","placeHoldIndex","children","indexOf","length","direction","placeholderElem","movePlaceholderAt","dragStop","elem","addItem","addEventListener","onPointerDown","dispatchEvent","CustomEvent","bubbles","details","item","elementInitialIndex","x","y","className","width","offsetWidth","height","offsetHeight","after","onDocumentPointerMove","onDocumentPointerUp","left","before","placeholderIndex","replaceWith","removeEventListener","detail","Page","toggle","renderCategoriesForm","data","map","categoryEl","id","title","querySelector","renderSubcategories","subcategories","category","subEl","count","fetchJson","template","getSubElements","loadData","subElements","categoriesContainer","initEventListeners","arr","querySelectorAll","dataset","counter","elemList","weight","result","method","headers","JSON","stringify","console","log","error","initClickHandle","saveOrder","component","Object","values","components","async","url","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","status","Error","super","window","reason","alert"],"mappings":"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","file":"categories-index-js-193.js","sourcesContent":["export default class NotificationMessage {\n  element;\n  constructor(message = '', {\n    duration = 1000,\n    type = 'success',\n  } = {}) {\n    this.duration = duration;\n    this.message = message;\n    this.type = type;\n    this.render();\n    if (NotificationMessage.isAlreadyShow) {\n      NotificationMessage.isAlreadyShow.remove(NotificationMessage.isAlreadyShow);\n    } else {\n      NotificationMessage.isAlreadyShow = false;\n    }\n  }\n  getTemplate () {\n    return `<div class=\"notification\" style=\"--value:2s\">\n    <div class=\"timer\"></div>\n    <div class=\"inner-wrapper\">\n      <div class=\"notification-header\">${this.type}</div>\n      <div class=\"notification-body\">${this.message}</div>\n    </div>\n  </div>`;\n  }\n  render() {\n    const element = document.createElement('div'); // (*)\n    element.innerHTML = this.getTemplate();\n    this.element = element.firstElementChild;\n    this.element.classList.add(this.type);\n  }\n  show(element = document.body) {\n    element.append(this.element);\n    NotificationMessage.isAlreadyShow = this.element;\n    const timer = setTimeout(() => this.remove(), this.duration);\n    return this.element;\n  }\n  remove() {\n    this.element.remove();\n  }\n  destroy() {\n    this.remove();\n  }\n}\n","export default class SortableList {\n  constructor({\n    items = []\n  } = {}) {\n    this.items = items;\n    this.render();\n  }\n  render() {\n    this.element = document.createElement(\"ul\");\n    this.element.classList.add('sortable-list');\n    for (const elem of this.items) {\n      this.addItem(elem);\n    }\n    this.element.addEventListener('pointerdown', this.onPointerDown);\n  }\n  onPointerDown = (event) => {\n    const element = event.target.closest('.sortable-list__item');\n    if (!element) return;\n    if (event.target.closest('[data-grab-handle]')) {\n      event.preventDefault();\n      this.elMove = element;\n      this.elShift = event.pageY - element.getBoundingClientRect().top;\n      event.preventDefault();\n      this.dragStart(element, event);\n    }\n    if (event.target.closest(\"[data-delete-handle]\")) {\n      this.removeItem(element);\n    }\n  };\n  addItem(elem) {\n    elem.classList.add(\"sortable-list__item\");\n    this.element.append(elem);\n  }\n  removeItem(element) {\n    element.remove();\n    this.element.dispatchEvent(new CustomEvent(\"sortable-list-delete\", {\n      bubbles: true,\n      details: {\n        item: element\n      }\n    }))\n  }\n  dragStart(element, {clientX, clientY}) {\n    this.elementInitialIndex = [...this.element.children].indexOf(element);\n    this.elShift = {\n      x: clientX - element.getBoundingClientRect().x,\n      y: clientY - element.getBoundingClientRect().y\n    };\n    this.elMove = element;\n    this.placeholderElem = document.createElement(\"div\");\n    this.placeholderElem.className = \"sortable-list__placeholder\";\n    element.style.width = element.offsetWidth + \"px\";\n    element.style.height = element.offsetHeight + \"px\";\n    this.placeholderElem.style.width = element.style.width;\n    this.placeholderElem.style.height = element.style.height;\n    element.classList.add(\"sortable-list__item_dragging\");\n    element.after(this.placeholderElem);\n    this.element.append(element);\n    this.moveDraggingAt(clientX, clientY);\n    document.addEventListener(\"pointermove\", this.onDocumentPointerMove);\n    document.addEventListener(\"pointerup\", this.onDocumentPointerUp);\n  }\n  moveDraggingAt(x, y) {\n    this.elMove.style.left = x - this.elShift.x + \"px\";\n    this.elMove.style.top = y - this.elShift.y + \"px\";\n  }\n  onDocumentPointerMove = (event) => {\n    this.moveDraggingAt(event.clientX, event.clientY);\n    this.elMove.style.display = 'none';\n    let elemBelow = document.elementFromPoint(event.clientX, event.clientY);\n    this.elMove.style.display = '';\n    if (!elemBelow) return;\n    const elFromList = elemBelow.closest('.sortable-list__item');\n    if (!elemBelow.closest('.sortable-list__placeholder') && elFromList) {\n      const placeHoldIndex = [...this.element.children].indexOf(elFromList);\n      if (placeHoldIndex > this.element.children.length || placeHoldIndex < 0) return;\n      const direction = elFromList.getBoundingClientRect().top > this.placeholderElem.getBoundingClientRect().top\n        ? 1 : 0;\n      this.movePlaceholderAt(elFromList, direction);\n    }\n  };\n  movePlaceholderAt(elFromList, direction) {\n    direction ? elFromList.after(this.placeholderElem) : elFromList.before(this.placeholderElem);\n\n  }\n  onDocumentPointerUp = () => {\n    this.dragStop();\n  };\n\n  dragStop () {\n    const placeholderIndex = [...this.element.children].indexOf(this.placeholderElem);\n    this.placeholderElem.replaceWith(this.elMove);\n    this.elMove.classList.remove('sortable-list__item_dragging');\n    this.elMove.style.width = '';\n    this.elMove.style.height = '';\n    this.elMove.style.left = '';\n    this.elMove.style.top = '';\n    this.placeholderElem.remove();\n    document.removeEventListener(\"pointermove\", this.onDocumentPointerMove);\n    document.removeEventListener(\"pointerup\", this.onDocumentPointerUp);\n    this.elMove = null;\n    if (placeholderIndex !== this.elementInitialIndex) {\n      this.element.dispatchEvent(new CustomEvent('sortable-list-reorder', {\n        bubbles: true,\n        detail: {\n          item: this.element,\n        }\n      }));\n    }\n  }\n\n  remove () {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.element.removeEventListener('pointerdown', this.onPointerDown);\n    document.removeEventListener(\"pointermove\", this.onDocumentPointerMove);\n    document.removeEventListener(\"pointerup\", this.onDocumentPointerUp);\n    this.element.remove();\n  }\n}\n","import fetchJson from '../../utils/fetch-json.js';\nimport SortableList from '../../components/sortable-list';\nimport NotificationMessage from '../../components/notification';\n\nconst BACKEND_URL = process.env.BACKEND_URL;\n\nexport default class Page {\n  subElements = {};\n  components = {};\n  initClickHandle = (event) => {\n    if(event.target.closest('.category__header')) {\n      event.target.closest('.category').classList.toggle('category_open')\n    }\n  };\n  renderCategoriesForm(data) {\n    return data.map(item => {\n          const categoryEl = document.createElement('div');\n          categoryEl.innerHTML = `<div class=\"category category_open\" data-id=\"${item.id}\">\n                      <header class=\"category__header\">\n                          ${item.title}\n                      </header>\n                      <div class=\"category__body\">\n                          <div class=\"subcategory-list\">\n                          </div>\n                      </div>\n                  </div>`;\n                  categoryEl.querySelector('.subcategory-list').append(this.renderSubcategories(item.subcategories));\n                  return categoryEl.firstElementChild;\n                })\n\n  }\n  renderSubcategories(category) {\n      const items  = category.map(elem => {\n        const subEl = document.createElement('div');\n        subEl.innerHTML = `<li class=\"categories__sortable-list-item\" data-grab-handle=\"\" data-id=\"${elem.id}\">\n                <strong>${elem.title}</strong>\n                <span><b>${elem.count}</b> products</span>`;\n        return subEl.firstElementChild;\n      });\n    return new SortableList({items}).element;\n  }\n  async loadData() {\n    return await fetchJson(`${BACKEND_URL}api/rest/categories?_sort=weight&_refs=subcategory`)\n  }\n\n  get template() {\n    return `<div class=\"categories\">\n                <div class=\"content__top-panel\">\n                    <h1 class=\"page-title\">Категории товаров</h1>\n                </div>\n                <p>Подкатегории можно перетаскивать, меняя их порядок внутри своей категории.</p>\n                <div data-element=\"categoriesContainer\">\n            \n                </div>\n            </div>`;\n  }\n\n  async render() {\n    const element = document.createElement('div');\n    element.innerHTML = this.template;\n    this.element = element.firstElementChild;\n    this.getSubElements(element);\n\n    const data = await this.loadData();\n    this.subElements.categoriesContainer.append(...this.renderCategoriesForm(data));\n    this.initEventListeners();\n    return this.element;\n  }\n  getSubElements(element) {\n    const arr = element.querySelectorAll('[data-element]');\n    for (const elem of arr) {\n      this.subElements[elem.dataset.element] = elem;\n    }\n  }\n  async saveOrder(elem) {\n    let counter = 1;\n    const elemList = [...elem.querySelectorAll(\"[data-id]\")].map(elem => ({\n      id: elem.dataset.id,\n      weight: counter++\n      })\n    );\n    try {\n      const result = await fetchJson(`${BACKEND_URL}api/rest/subcategories`,\n        {\n          method: 'PATCH',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify(elemList)\n        });\n      console.log(result);\n      const notification = new NotificationMessage('Category order saved', {\n        duration: 2000,\n        type: 'success'\n      });\n\n      notification.show();\n    } catch (error) {\n      console.error('Ошибка в отправке формы', error);\n    }\n  }\n\n  initEventListeners() {\n    this.element.addEventListener('click', this.initClickHandle);\n    this.element.addEventListener('sortable-list-reorder', event => {\n      this.saveOrder(event.detail.item);\n      })\n  }\n  destroy() {\n    this.subElements.categoriesContainer.removeEventListener('click', this.initClickHandle);\n    this.subElements = {};\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\r\n// status >= 400 is an error\r\n// network error / json error are errors\r\n\r\nexport default async function(url, params) {\r\n  let response;\r\n\r\n  try {\r\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\r\n    response = await fetch(url.toString(), params);\r\n  } catch(err) {\r\n    throw new FetchError(response, \"Network error has occurred.\");\r\n  }\r\n\r\n  let body;\r\n\r\n  if (!response.ok) {\r\n    let errorText = response.statusText; // Not Found (for 404)\r\n\r\n    try {\r\n      body = await response.json();\r\n\r\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\r\n    } catch (error) { /* ignore failed body */ }\r\n\r\n    let message = `Error ${response.status}: ${errorText}`;\r\n\r\n    throw new FetchError(response, body, message);\r\n  }\r\n\r\n  try {\r\n    return await response.json();\r\n  } catch(err) {\r\n    throw new FetchError(response, null, err.message);\r\n  }\r\n}\r\n\r\nexport class FetchError extends Error {\r\n  name = \"FetchError\";\r\n\r\n  constructor(response, body, message) {\r\n    super(message);\r\n    this.response = response;\r\n    this.body = body;\r\n  }\r\n}\r\n\r\n// handle uncaught failed fetch through\r\nwindow.addEventListener('unhandledrejection', event => {\r\n  if (event.reason instanceof FetchError) {\r\n    alert(event.reason.message);\r\n  }\r\n});\r\n\r\n"],"sourceRoot":""}